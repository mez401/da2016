---
title: "Лабораторная работа 3"
author: "Мезенцева Алена"
date: '19 ноября 2016 г '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Исходные данные

Список богатейших американцев по версии журнала Форбс.

## Задание 1

1. Используйте команду readLines для загрузки файла в текстовый вектор html.

```{r}
data.forbes <- readLines("https://raw.githubusercontent.com/SergeyMirvoda/da2016/master/data/forbes.htm")
```

* Сколько строк в файле?

```{r}
length(data.forbes)
```

* Сколько символов в файле?

```{r}
sum(nchar(data.forbes))
```

2. Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе и Ларри Эллисоне и запомните размер их дохода.

    Билл Гейтс - 72 млрд. дол.
    Ларри Эллисон - 41 млрд. дол.
    
3. Напишите шаблон регулярного выражения и используйте функцию grep, чтобы извлечь размер дохода из данных в векторе html. Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть информация о доходе, а не просто первый попавшийся текст.

```{r}
shablon = "(\\d{1,2}[,]?\\d?)\\sB"
worth <- grep(shablon, data.forbes)
data.forbes[worth]
```

4. Напишите код, использовав регулярное выражение из п. 3, и функции regexp и regmatches, чтобы извлечь все данные о доходе. Проверьте следующее:

```{r}
match <- regmatches(data.forbes,regexpr(shablon,data.forbes))
```

* Должно быть ровно сто значений.

```{r}
length(match)
```

* Самый большой доход должен быть доход Билла Гейтса

```{r}
match[1]
```

* Такой доход должен быть в списке один раз.

```{r}
length(match[match =="72 B"])
```

* В списке должна быть цифра, которую мы запомнили для Ларри Эллисона.

```{r}
length(match[match =="41 B"])
```

* Должно быть как минимум два значения, встречающихся несколько раз.

```{r}
length(match[match =="36 B"])
length(match[match =="5 B"])
```

## Задание 2

1. В данных доход представлен в формате "$42 B", что означает 42 × 10^9. Преобразуйте этот формат в числовой и сохраните в вектор worths. 

```{r}
worth <-substr(match,1,nchar(match))
worth <- sub(' B', '', worth)
worth <- sub(',', '.', worth)
worths <- as.numeric(worth)*10**9
```

Удостоверьтесь в следующем:
- worths является вектором и в нём сто значений типа double.

```{r}
length(worths)
typeof(worths)
```

- Все элементы вектора worths больше 1 миллиарда.

```{r}
length(worths[worths>=10**9])
```

- Самое большое число это доход Билла Гейтса.

```{r}
max(worths)
```

2. Используйте вектор worths , чтобы выяснить следующее:

- Какова медиана ста этих записей?

```{r}
median(worths)
```

- Средний доход?

```{r}
mean(worths)
```

- Как много людей из этого списка имеют доход больше 5млрд., 10, 25?

```{r}
length(worths[worths>5*10**9])
length(worths[worths>10*10**9])
length(worths[worths>25*10**9])
```

- Какой их общий доход?

```{r}
sum(worths)
```

- Какую долю от общего дохода, составляет пятёрка самых богатых.

```{r}
sum(worths[1:5])/sum(worths)*100
```

- Какую долю от общего дохода, составляют 20 самых богатых.

```{r}
sum(worths[1:20])/sum(worths)*100
```

- В данных федерального резерва США найдите показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю общего дохода составляют 100 богатейших людей.

```{r}
hnw <- 56.047*10**12
sum(worths)/hnw*100
```